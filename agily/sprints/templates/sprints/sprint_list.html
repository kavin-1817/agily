{% extends 'sprints/base.html' %}

{% block page_title %}Sprints{% endblock %}

{% block content %}
<div class="container">
  <div class="section">
    <div class="level" style="margin-bottom: 1em;">
      <div class="level-left">
        <h2 class="title" style="margin-right: 1.5em;">Sprints</h2>
        <form method="get" class="level-item" style="margin-bottom: 0; display: flex; align-items: center;">
          {{ search_form.q }}
          <button class="button is-link" type="submit" style="margin-left: 0.5em;">
            <span class="icon is-small">
              <i class="fas fa-search"></i>
            </span>
            <small>Search</small>
          </button>
        </form>
      </div>
      <div class="level-right">
        {% if is_project_admin or user_is_superuser %}
          <a class="button is-link" href="{% url 'sprints:sprint-add' current_workspace %}">
            <span class="icon is-small"><i class="fas fa-plus"></i></span>
            <small>Create</small>
          </a>
        {% endif %}
      </div>
    </div>
    <table class="table is-bordered is-striped is-hoverable is-fullwidth">
      <thead>
        <tr>
          <th>ID</th>
          <th>Title</th>
          <th>Start</th>
          <th>End</th>
          <th>State</th>
          <th>Project</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for sprint in object_list %}
          <tr>
            <td>#{{ sprint.id }}</td>
            <td><b>{{ sprint.title }}</b></td>
            <td>{{ sprint.starts_at|date:"Y-m-d" }}</td>
            <td>{{ sprint.ends_at|date:"Y-m-d" }}</td>
            <td>{{ sprint.get_state_display }}</td>
            <td>{{ sprint.project }}</td>
            <td>
              <a href="{% url 'sprints:sprint-detail' current_workspace sprint.id %}" title="View" style="width:2.5em; height:2.5em; background:#8FA01F !important; color:white !important; border-radius:6px; display:inline-flex; align-items:center; justify-content:center; border:none; margin-right:0.3em; text-decoration:none;"><i class="fas fa-eye" style="color:white;"></i></a>
              {% if is_project_admin or user.is_superuser %}
                <a href="{% url 'sprints:sprint-edit' current_workspace sprint.id %}?next={{ encoded_url }}" title="Edit" style="width:2.5em; height:2.5em; background:#1B4F72; color:white; border-radius:6px; display:inline-flex; align-items:center; justify-content:center; border:none; margin-right:0.3em; text-decoration:none;"><i class="fas fa-edit" style="color:white;"></i></a>
                <form method="post" action="{% url 'sprints:sprint-delete' current_workspace sprint.id %}" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" name="remove" value="yes" title="Remove" onclick="return confirm('Are you sure you want to remove this sprint?');" style="width:2.5em; height:2.5em; background:#943126; color:white; border-radius:6px; display:inline-flex; align-items:center; justify-content:center; border:none; padding:0;"><i class="fas fa-trash" style="color:white;"></i></button>
                </form>
              {% endif %}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="7">No sprints found.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <br/>
    {% include "paginator.html" %}
  </div>
</div>
{% endblock %}
